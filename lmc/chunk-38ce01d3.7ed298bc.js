(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38ce01d3"],{"0c9e":function(e,t,o){"use strict";o("2a64")},"1b6d":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"photo-wrap"},[t("header",{staticClass:"photo-header"},[t("van-image",{attrs:{width:"100",height:"100",src:e.portrait},on:{click:function(t){return e.showImage(e.portrait)}}}),t("div",{staticClass:"header-personal"},[t("div",[t("span",{staticClass:"header-personal-name"},[e._v(e._s(e.form.permitName))]),t("span",[e._v(e._s(e.form.permitPhone))])]),t("div",[t("span",[e._v(e._s(e.form.cardNo))])]),t("div",[t("span",[e._v(e._s(e.form.clientName))])])])],1),t("div",{staticClass:"photo-main"},[t("van-cell",{attrs:{title:e.$hxt({key:"d5ff13-TrainingDate",desc:"培训日期"}),value:e.form.trainDate}}),t("van-cell",{attrs:{title:e.$hxt({key:"d5ff13-ValidityPeriodOfOperationCertificate",desc:"操作证有效期"}),value:e.form.expireEndDate}}),t("van-cell",{attrs:{title:e.$hxt({key:"d5ff13-OperationCertificateNumber",desc:"操作证编号"}),value:e.form.permitNo}}),e.form.equipmentCategoryDesc?t("div",{staticClass:"type-wrap"},[t("span",[e._v(e._s(e.$hxt({key:"d5ff13-OperationModel",desc:"操作机型"})))]),e._v(" "+e._s(e.form.equipmentCategoryDesc)+" ")]):t("nav",{staticClass:"photo-main-nav"},[e._v(" "+e._s(e.$hxt({key:"d5ff13-OperationModel",desc:"操作机型"}))+" ")]),e.form.equipmentCategoryDesc?e._e():t("div",{staticClass:"model-wrap"},e._l(e.form.modelCodes,(function(o,a){return t("div",{key:a,staticClass:"model-content"},[e._v(" "+e._s(o.modelCode)+" ")])})),0)],1),t("div",{staticClass:"photo-footer"},[t("div",{staticClass:"photo-title"},[e._v(" "+e._s(e.$hxt({key:"d5ff13-SignaturePhotoOperationTrainingFormSignaturePhoto",desc:"签字照片——操作培训单签字照片"}))+" ")]),t("div",{staticClass:"photo-content"},e._l(e.form.signPhotos,(function(o,a){return t("van-image",{key:a,attrs:{width:"100",height:"100",src:o.attachmentUrl},on:{click:function(t){return e.showImage(o.attachmentUrl)}}})})),1)]),t("div",{staticClass:"photo-footer"},[t("div",{staticClass:"photo-title"},[e._v(" "+e._s(e.$hxt({key:"d5ff13-TrainingPhotos",desc:"培训照片"}))+" ")]),t("div",{staticClass:"photo-content"},e._l(e.form.trainPhotos,(function(o,a){return t("van-image",{key:a,attrs:{width:"100",height:"100",src:o.attachmentUrl},on:{click:function(t){return e.showImage(o.attachmentUrl)}}})})),1)]),t("van-image-preview",{attrs:{images:e.photoListShow,startPosition:e.previewIndex},model:{value:e.previewshow,callback:function(t){e.previewshow=t},expression:"previewshow"}})],1)},n=[],i=(o("e7e5"),o("d399")),r=(o("99af"),o("ac1f"),o("00b4"),o("cf45")),s=o("bc3a"),c=o.n(s),l=o("b893"),d=o("ed08"),u=d["a"].OPENBASE,p={name:"photo",data:function(){return{form:{permitPhone:"",modelCodeList:[]},no:"",previewshow:!1,photoListShow:[],previewIndex:0}},mounted:function(){var e=this.$route.params.no;this.no=e,this.getInfo()},methods:{getInfo:function(){var e=this;c.a.post("".concat(u,"/api-equ-biz/open-api/equ/operator-permit-detail/query-by-permit-no?permitNo=").concat(this.no),{permitNo:this.no},{headers:Object(l["b"])({permitNo:this.no})}).then((function(t){200===t.status?t.data&&200===t.data.code?(e.form=t.data.data,Object(r["replaceDomain"])(e.form.trainPhotos,"attachmentUrl"),Object(r["replaceDomain"])(e.form.signPhotos,"attachmentUrl")):Object(i["a"])(t.data.msg):Object(i["a"])($hxt({key:"d5ff13-FailedToObtainInformationPleaseRefreshAndTryAgain",desc:"获取信息失败，请刷新后重试！"}))}))},showImage:function(e){this.previewshow=!0,/http/.test(e)?this.photoListShow=[e]:this.photoListShow=[Object(r["getFileurl"])()+e]}},computed:{portrait:function(){return this.form.photoUrl?/http/.test(this.form.photoUrl)?this.form.photoUrl:Object(r["getFileurl"])()+this.form.photoUrl:""}}},h=p,f=(o("0c9e"),o("2877")),m=Object(f["a"])(h,a,n,!1,null,"1dd15ca3",null);t["default"]=m.exports},"2a64":function(e,t,o){},b893:function(e,t,o){"use strict";o.d(t,"c",(function(){return p})),o.d(t,"b",(function(){return m})),o.d(t,"a",(function(){return v}));var a=o("c7eb"),n=o("1da1"),i=(o("e7e5"),o("d399")),r=o("b85c"),s=(o("d3b7"),o("a9e3"),o("ac1f"),o("5319"),o("4de4"),o("159b"),o("14d9"),o("3ca3"),o("ddb0"),o("25f0"),o("99af"),o("e9c4"),o("18a0")),c=o.n(s),l=o("e199"),d=(o("ac78"),o("6821")),u=o.n(d);o("01ea");function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;return new Promise((function(o,s){var l=e.sizeType,d=void 0===l?["compressed"]:l,u=e.sourceType,p=void 0===u?["album","camera"]:u,m=e.isSaveToAlbum,v=void 0===m?1:m,g=e.count,w=void 0===g?9:g,b=e.sceneName,O=void 0===b?$hxt({key:"146872-GeneralFieldWorkOrder",desc:"通用外场工单"}):b,y=e.sceneCode,P=void 0===y?"GENERAL_EXTERNAL_RECEIPT":y,k=e.isWatermark;console.log("count--",w),console.log(window.isApp,"log------"),window.isApp||void 0===window.isApp?hx.ready((function(){console.log(e);var a=hx.getAppInfo().APPOS,n=hx.getAppInfo().APPVersion;console.log("window.isLOG",window.isLOG),console.log("APPOS---",a),console.log("APPVersion---",n),console.log("APPOS","Android"===a),console.log("APPVersion",Number(n)>=1370);var s=!window.isLOG&&("Android"===a&&Number(n)>=1370||"iOS"===a&&Number(n)>=94);console.log("versionValid",s);var c=window.isLOG&&("Android"===a&&Number(n.replace(/\./g,""))>=163||"iOS"===a&&Number(n.replace(/\./g,""))>=163);(c||s)&&k?(console.log("水印相机",O,P),hx.uploadWatermarkImage({isFront:0,isRemake:1,isSaveToAlbum:0,type:1,count:w,limit:t,needMirrorHandle:1,sceneName:O,sceneCode:P,success:function(e){if(console.log(e,"-----1res-------"),e&&e.length){var t,a=Object(r["a"])(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.filePath=n.url}}catch(i){a.e(i)}finally{a.f()}}o(e)},error:function(e){console.log(e,"-----------error-----------"),o(),Object(i["a"])($hxt({key:"146872-FailedToObtainImagePleaseUploadAgain",desc:"获取图片失败,请重新上传"}))}})):hx.uploadImage({isFront:0,isRemake:1,isSaveToAlbum:0,type:0,watermark:0,count:w,limit:t,success:function(e){console.log(e,"app获取照片res"),o(e)},error:function(e){console.log(e,"error"),o(),Object(i["a"])($hxt({key:"146872-FailedToObtainImagePleaseUploadAgain",desc:"获取图片失败,请重新上传"}))}})})):c.a.chooseImage({sizeType:d,sourceType:p,defaultCameraMode:"normal",isSaveToAlbum:v,success:function(){var e=Object(n["a"])(Object(a["a"])().mark((function e(t){var n,r,s,c;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.localIds,console.log("localIds--",n),e.next=4,h(n);case 4:if(r=e.sent,console.log("mediaIdList--",r),s=r.filter((function(e){return!!e})),console.log("mediaIds--",s),!s||!s[0]){e.next=15;break}return e.next=11,f(s);case 11:c=e.sent,o(c),e.next=17;break;case 15:Object(i["a"])($hxt({key:"146872-UploadFailedPleaseTryAgain",desc:"上传失败，请重试"})),o();case 17:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),fail:function(e){s(e)}})}))}var h=function(){var e=Object(n["a"])(Object(a["a"])().mark((function e(t){var o,n;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(c.a.uploadImage,"wx.uploadImage"),o=[],i["a"].loading({duration:0,forbidClick:!0,message:$hxt({key:"146872-PictureUploadInProgress",desc:"图片上传中..."})}),t.forEach((function(e){console.log("localId--",e),o.push(new Promise((function(t){setTimeout((function(){c.a.uploadImage({localId:e,isShowProgressTips:0,success:function(e){var o=e.serverId;console.log("微信临时素材上传成功",e),t(o)},fail:function(e){console.log("微信临时素材上传失败",e),t(!1)}})}),100)})))})),e.next=6,Promise.all(o);case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function f(e){return new Promise((function(t){Object(l["f"])({mediaIdList:e}).then((function(e){Object(i["a"])($hxt({key:"146872-PictureUploadedSuccessfully",desc:"图片上传成功"})),200==e.code?t(e.data):t()})).catch((function(e){Object(i["a"])($hxt({key:"146872-ImageUploadFailed",desc:"图片上传失败"})),t()}))}))}function m(e){var t="12345678",o="equ-biz",a=Date.parse(new Date).toString().substr(0,10),n="".concat(o,"&").concat(a,"&").concat(t).concat(e?"&"+JSON.stringify(e):"");return{appid:o,timestamp:a,sign:u()(n)}}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:11,o=e.toString();o=o.replace(/[^\d]/g,"");while(o.length>t)o=o.substr(0,o.length-1);return Number(o)}}}]);